<div class="profile">
  <h2>Profil utilizator</h2>
  <div>
    <p><strong>Username:</strong> {{ userProfile.username }}</p>
    <p><strong>Email:</strong> {{ userProfile.email }}</p>
    <p>
      <strong>Nume:</strong> {{ userProfile.firstName }}
      {{ userProfile.lastName }}
    </p>
    <p><strong>Telefon:</strong> {{ userProfile.phone }}</p>
  </div>
</div>
<div class="buttons">
  <button
    mat-raised-button
    color="primary"
    (click)="toggleView('appointments')"
  >
    ProgramÄƒri
  </button>
  <button mat-raised-button color="primary" (click)="toggleView('wishlist')">
    Wishlist
  </button>
</div>
<p style="margin-top: 50px"></p>
<div *ngIf="showAppointments" class="table-container">
  <div *ngIf="appointments.length > 0 || appointmentsTechnician.length > 0">
    <div *ngIf="role === 'custom'">
      <table mat-table [dataSource]="appointments" class="mat-elevation-z8">
        <ng-container matColumnDef="Name">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Nume</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.nameType }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Data">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Data</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.date | date : "dd/MM/yyyy HH:mm:ss" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Technician">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">
            Technician
          </th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.technicianFirstName }} {{ element.technicianLastName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Phone">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Phone</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.technicianPhone }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Email">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Email</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.technicianEmail }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Status">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Status</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.status }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Actions">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">
            Actions
          </th>
          <td mat-cell *matCellDef="let element" style="color: black">
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                element.status === 'Pending' &&
                (userProfile.role === 'custom' ||
                  userProfile.role === 'technician')
              "
              (click)="
                updateAppointmentStatus(element.idAppointment, 'Canceled')
              "
            >
              <mat-icon>cancel</mat-icon>
            </button>
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                userProfile.role !== 'custom' &&
                element.status === 'Pending'
              "
              (click)="updateAppointmentStatus(element.idAppointment, 'Done')"
            ></button>
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                userProfile.role !== 'custom' &&
                element.status === 'Pending'
              "
              (click)="
                updateAppointmentStatus(element.idAppointment, 'Can`t fix')
              "
            >
              Can't fix
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
    <div *ngIf="role === 'technician'">
      <table
        mat-table
        [dataSource]="appointmentsTechnician"
        class="mat-elevation-z8"
        style="background-color: #ffffff"
      >
        <ng-container matColumnDef="Name">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Nume</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.nameType }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Data">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Data</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.date | date : "dd/MM/yyyy HH:mm:ss" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Utilizator">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">User</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.userFirstName }} {{ element.userLastName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Phone">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Phone</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.userPhone }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Email">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Email</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.userEmail }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Status">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Status</th>
          <td mat-cell *matCellDef="let element" style="color: black">
            {{ element.status }}
          </td>
        </ng-container>

        <ng-container matColumnDef="Actions">
          <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">
            Actions
          </th>
          <td mat-cell *matCellDef="let element" style="color: black">
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                element.status === 'Pending' &&
                (userProfile.role === 'custom' ||
                  userProfile.role === 'technician')
              "
              (click)="
                updateAppointmentStatus(element.idAppointment, 'Canceled')
              "
            >
              <mat-icon>cancel</mat-icon>
            </button>
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                userProfile.role !== 'custom' &&
                element.status === 'Pending'
              "
              (click)="updateAppointmentStatus(element.idAppointment, 'Done')"
            >
              <mat-icon>done</mat-icon>
            </button>
            <button
              *ngIf="
                element.idAppointment !== undefined &&
                userProfile.role !== 'custom' &&
                element.status === 'Pending'
              "
              (click)="
                updateAppointmentStatus(element.idAppointment, 'Can`t fix')
              "
            >
              <mat-icon>error</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsTechnician"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumnsTechnician"
        ></tr>
      </table>
    </div>
  </div>
</div>

<div class="table-container">
  <div *ngIf="showWishlist">
    <table
      mat-table
      [dataSource]="wishList"
      class="mat-elevation-z8"
      style="background-color: #ffffff"
    >
      <ng-container matColumnDef="Name Product">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">
          Name Product
        </th>
        <td mat-cell *matCellDef="let element" style="color: black">
          {{ element.nameProduct }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Price">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Price</th>
        <td mat-cell *matCellDef="let element" style="color: black">
          {{ element.price }}
        </td>
      </ng-container>

      <ng-container matColumnDef="linkProduct">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Link</th>
        <td mat-cell *matCellDef="let element" style="color: black">
          <a [href]="element.linkProduct" target="_blank">View Product</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="linkImage">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Image</th>
        <td mat-cell *matCellDef="let element" style="color: black">
          <img [src]="element.linkImage" alt="Product Image" />
        </td>
      </ng-container>

      <ng-container matColumnDef="Company">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Company</th>
        <td mat-cell *matCellDef="let element" style="color: black">
          {{ element.company }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Actions">
        <th mat-header-cell *matHeaderCellDef style="color: black; text-align: center;">Actions</th>
        <td mat-cell *matCellDef="let element" style="color: black">
          <button mat-icon-button color="warn" (click)="deleteProductFromWishList(element.idWishlist)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsWishList"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsWishList"></tr>
    </table>
  </div>
</div>
<div *ngIf="!haveAppointment">Nu aveti programari</div>
