<div class="profile">
  <h2>Profil utilizator</h2>
  <div>
    <p><strong>Username:</strong> {{ userProfile.username }}</p>
    <p><strong>Email:</strong> {{ userProfile.email }}</p>
    <p>
      <strong>Nume:</strong> {{ userProfile.firstName }}
      {{ userProfile.lastName }}
    </p>
    <p><strong>Telefon:</strong> {{ userProfile.phone }}</p>
  </div>
</div>
<div class="buttons">
  <button mat-raised-button color="primary" (click)="toggleView('appointments')">Programări</button>
  <button mat-raised-button color="primary" (click)="toggleView('wishlist')">Wishlist</button>
</div>
<div *ngIf="showAppointments">
  <div *ngIf="appointments.length > 0 || appointmentsTechnician.length > 0">
    <div *ngIf="role==='custom'">
      <table class="appointments">
        <thead>
          <tr>
            <th>Nume</th>
            <th>Date</th>
            <th>Technician</th>
            <th>Telefon Technician</th>
            <th>Email Technician</th>
            <th>Status</th>
            <th>Acțiuni</th>
          </tr>
        </thead>
        <tbody>
            <tr *ngFor="let appointment of appointments">
              <td>{{ appointment.nameType }}</td>
              <td>{{ appointment.date | date : "dd/MM/yyyy HH:mm:ss" }}</td>
              <td>
                {{ appointment.technicianFirstName }} {{ appointment.technicianLastName }}
              </td>
              <td>{{ appointment.technicianPhone }}</td>
              <td>{{ appointment.technicianEmail }}</td>
              <td>{{ appointment.status }}</td>
              <td>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    appointment.status === 'Pending' &&
                    (userProfile.role === 'custom' || userProfile.role === 'technician')
                  "
                  (click)="
                    updateAppointmentStatus(appointment.idAppointment, 'Canceled')
                  "
                >
                  Cancel
                </button>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    (userProfile.role !== 'custom' &&
                      appointment.status === 'Pending')
                  "
                  (click)="updateAppointmentStatus(appointment.idAppointment, 'Done')"
                >
                  Done
                </button>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    (userProfile.role !== 'custom' &&
                      appointment.status === 'Pending')
                  "
                  (click)="updateAppointmentStatus(appointment.idAppointment, 'Can`t fix')"
                >
                  Can't fix
                </button>
              </td>
            </tr>
        </tbody>
      </table>
    </div>
      <div *ngIf="role==='technician'">
      <table class="appointments">
        <thead>
          <tr>
            <th>Nume</th>
            <th>Date</th>
            <th>Utilizator</th>
            <th>Telefon Utilizator</th>
            <th>Email Utilizator</th>
            <th>Status</th>
            <th>Acțiuni</th>
          </tr>
        </thead>
        <tbody>
            <tr *ngFor="let appointment of appointmentsTechnician">
              <td>{{ appointment.nameType }}</td>
              <td>{{ appointment.date | date : "dd/MM/yyyy HH:mm:ss" }}</td>
              <td>
                {{ appointment.userFirstName }} {{ appointment.userLastName }}
              </td>
              <td>{{ appointment.userPhone }}</td>
              <td>{{ appointment.userEmail }}</td>
              <td>{{ appointment.status }}</td>
              <td>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    appointment.status === 'Pending' &&
                    (userProfile.role === 'custom' || userProfile.role === 'technician')
                  "
                  (click)="
                    updateAppointmentStatus(appointment.idAppointment, 'Canceled')
                  "
                >
                  Cancel
                </button>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    (userProfile.role !== 'custom' &&
                      appointment.status === 'Pending')
                  "
                  (click)="updateAppointmentStatus(appointment.idAppointment, 'Done')"
                >
                  Done
                </button>
                <button
                  *ngIf="
                    appointment.idAppointment !== undefined &&
                    (userProfile.role !== 'custom' &&
                      appointment.status === 'Pending')
                  "
                  (click)="updateAppointmentStatus(appointment.idAppointment, 'Can`t fix')"
                >
                  Can't fix
                </button>
              </td>
            </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<div *ngIf="showWishlist">
  <table class="wishlist">
    <thead>
      <tr>
        <th>Nume Produs</th>
        <th>Preț</th>
        <th>Companie</th>
        <th>Imagine</th>
        <th>Acțiuni</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let wish of this.wishList">
        <td>{{ wish.nameProduct }}</td>
        <td>{{ wish.price }}</td>
        <td>{{ wish.company }}</td>
        <td><img [src]="wish.linkImage" alt="Product Image"></td>
        <td>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div *ngIf="!haveAppointment">Nu aveti programari</div>



<table mat-table [dataSource]="appointments" class="mat-elevation-z8" style="background-color: #ffffff">

  <!--- Note that these columns can be defined in any order.
        The actual rendered columns are set as a property on the row definition" -->

  <!-- Position Column -->
  <ng-container matColumnDef="Nume" >
    <th mat-header-cell *matHeaderCellDef style="color:black"> Nume </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.nameType}} </td>
  </ng-container>

  <!-- Name Column -->
  <ng-container matColumnDef="Data">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Data </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.date}} </td>
  </ng-container>

  <!-- Weight Column -->
  <ng-container matColumnDef="Technician">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Technician </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.technicianFirstName}} {{element.technicianLastName}}</td>
  </ng-container>

  <!-- Symbol Column -->
  <ng-container matColumnDef="Phone">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Phone </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.technicianPhone}} </td>
  </ng-container>

  <!-- Symbol Column -->
  <ng-container matColumnDef="Email">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Email </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.technicianEmail}} </td>
  </ng-container>

  <!-- Symbol Column -->
  <ng-container matColumnDef="Status">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Status </th>
    <td mat-cell *matCellDef="let element" style="color:black"> {{element.status}} </td>
  </ng-container>

  <ng-container matColumnDef="Actions">
    <th mat-header-cell *matHeaderCellDef style="color:black"> Actions </th>
    <td mat-cell *matCellDef="let element" style="color:black"> <button
      *ngIf="
        element.idAppointment !== undefined &&
        element.status === 'Pending' &&
        (userProfile.role === 'custom' || userProfile.role === 'technician')
      "
      (click)="
        updateAppointmentStatus(element.idAppointment, 'Canceled')
      "
    >
      Cancel
    </button>
    <button
      *ngIf="
        element.idAppointment !== undefined &&
        (userProfile.role !== 'custom' &&
        element.status === 'Pending')
      "
      (click)="updateAppointmentStatus(element.idAppointment, 'Done')"
    >
      Done
    </button>
    <button
      *ngIf="
        element.idAppointment !== undefined &&
        (userProfile.role !== 'custom' &&
        element.status === 'Pending')
      "
      (click)="updateAppointmentStatus(element.idAppointment, 'Can`t fix')"
    >
      Can't fix
    </button> </td>
  </ng-container>


  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>